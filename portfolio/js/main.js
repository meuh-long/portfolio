window.addEventListener("load",(function(){window.location.hash&&history.replaceState(null,null," "),window.scrollTo(0,0)}));const hamburgerBtn=document.getElementById("hamburgerBtn"),mainNav=document.getElementById("mainNav"),navLinks=document.querySelectorAll(".nav-link");hamburgerBtn&&mainNav&&(hamburgerBtn.addEventListener("click",(function(){const e=hamburgerBtn.classList.contains("active");hamburgerBtn.classList.toggle("active"),mainNav.classList.toggle("active"),hamburgerBtn.setAttribute("aria-expanded",!e),hamburgerBtn.setAttribute("aria-label",e?"Ouvrir le menu de navigation":"Fermer le menu de navigation")})),navLinks.forEach((e=>{e.addEventListener("click",(function(){hamburgerBtn.classList.remove("active"),mainNav.classList.remove("active"),hamburgerBtn.setAttribute("aria-expanded","false"),hamburgerBtn.setAttribute("aria-label","Ouvrir le menu de navigation")}))})),document.addEventListener("click",(function(e){const t=mainNav.contains(e.target),n=hamburgerBtn.contains(e.target);t||n||!mainNav.classList.contains("active")||(hamburgerBtn.classList.remove("active"),mainNav.classList.remove("active"),hamburgerBtn.setAttribute("aria-expanded","false"),hamburgerBtn.setAttribute("aria-label","Ouvrir le menu de navigation"))})));const decreaseBtn=document.getElementById("decreaseFont"),resetBtn=document.getElementById("resetFont"),increaseBtn=document.getElementById("increaseFont"),fontSizeIndicator=document.getElementById("fontSizeIndicator");let currentFontSize=100;const minFontSize=80,maxFontSize=150,fontStep=10,header=document.querySelector(".header");function updateActiveNavLink(){const e=document.querySelectorAll("section[id]"),t=document.querySelectorAll(".nav-link");let n="";e.forEach((e=>{const t=e.offsetTop;e.clientHeight;window.scrollY>=t-100&&(n=e.getAttribute("id"))})),t.forEach((e=>{e.classList.remove("active"),e.getAttribute("href")==="#"+n&&e.classList.add("active")}))}function applyFontSize(e){document.documentElement.style.fontSize=e/100*16+"px",document.body.style.fontSize=e/100*16+"px",fontSizeIndicator&&(fontSizeIndicator.textContent=e+"%",100!==e?fontSizeIndicator.classList.add("changed"):fontSizeIndicator.classList.remove("changed")),localStorage.setItem("fontSize",e),console.log("Font size applied:",e+"%","Calculated px:",e/100*16+"px")}window.addEventListener("scroll",(function(){window.scrollY>50?header.classList.add("scrolled"):header.classList.remove("scrolled"),updateActiveNavLink()})),navLinks.forEach((e=>{e.addEventListener("click",(function(e){navLinks.forEach((e=>e.classList.remove("active"))),this.classList.add("active"),hamburgerBtn.classList.remove("active"),mainNav.classList.remove("active")}))})),updateActiveNavLink(),localStorage.getItem("fontSize")&&(currentFontSize=parseInt(localStorage.getItem("fontSize")),applyFontSize(currentFontSize)),decreaseBtn&&increaseBtn&&resetBtn&&fontSizeIndicator&&(decreaseBtn.addEventListener("click",(function(){currentFontSize>80&&(currentFontSize-=10,applyFontSize(currentFontSize),this.style.transform="scale(0.9)",setTimeout((()=>{this.style.transform=""}),100))})),increaseBtn.addEventListener("click",(function(){currentFontSize<150&&(currentFontSize+=10,applyFontSize(currentFontSize),this.style.transform="scale(1.1)",setTimeout((()=>{this.style.transform=""}),100))})),resetBtn.addEventListener("click",(function(){currentFontSize=100,applyFontSize(currentFontSize),this.style.transform="rotate(360deg)",setTimeout((()=>{this.style.transform=""}),300)})));const dyslexicBtn=document.getElementById("dyslexicBtn"),dyslexicStatus=document.getElementById("dyslexicStatus");"true"===localStorage.getItem("dyslexicMode")&&(document.body.classList.add("dyslexic-mode"),dyslexicBtn&&dyslexicBtn.classList.add("active"),dyslexicStatus&&(dyslexicStatus.classList.add("active"),dyslexicStatus.textContent=dyslexicStatus.textContent.includes("Inactive")||dyslexicStatus.textContent.includes("Désactivée")?"fr"===document.documentElement.lang?"Activée":"Active":dyslexicStatus.textContent)),dyslexicBtn&&dyslexicStatus&&dyslexicBtn.addEventListener("click",(function(){document.body.classList.toggle("dyslexic-mode"),this.classList.toggle("active"),dyslexicStatus.classList.toggle("active");const e=document.body.classList.contains("dyslexic-mode");"fr"===document.documentElement.lang?dyslexicStatus.textContent=e?"Activée":"Désactivée":dyslexicStatus.textContent=e?"Active":"Inactive",localStorage.setItem("dyslexicMode",e),this.style.transform="scale(0.95)",setTimeout((()=>{this.style.transform=""}),150),console.log("Dyslexic mode:",e?"ON":"OFF")}));const accessPanel=document.getElementById("accessPanel"),minimizeBtn=document.getElementById("minimizeBtn");if(accessPanel&&minimizeBtn){let e,t=null,n=null,o=null,i=null;function cleanupListeners(){t&&(accessPanel.removeEventListener("click",t),t=null),n&&(minimizeBtn.removeEventListener("click",n),n=null),o&&(document.removeEventListener("click",o),o=null)}function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function handleMobileBehavior(){const e=window.innerWidth,c=isTouchDevice(),s=e<=768?"mobile":"desktop";s!==i&&(console.log("Mode changed to:",s,"Width:",e,"Touch device:",c),i=s,cleanupListeners(),e<=768?(console.log("Setting up mobile behavior"),accessPanel.classList.remove("minimized"),t=function(e){this.classList.contains("expanded")||e.target.closest(".minimize-btn")||e.target.closest(".font-btn")||e.target.closest(".dyslexic-btn")||(this.classList.add("expanded"),console.log("Panel expanded"),e.stopPropagation())},n=function(e){console.log("Minimize button clicked"),e.preventDefault(),e.stopPropagation(),accessPanel.classList.remove("expanded"),console.log("Panel collapsed")},o=function(e){!accessPanel.contains(e.target)&&accessPanel.classList.contains("expanded")&&(console.log("Click outside, closing panel"),accessPanel.classList.remove("expanded"))},accessPanel.addEventListener("click",t),minimizeBtn.addEventListener("click",n,!0),document.addEventListener("click",o)):(console.log("Setting up desktop/tablet behavior"),accessPanel.classList.remove("expanded"),t=function(e){!this.classList.contains("minimized")||e.target.closest(".minimize-btn")||e.target.closest(".font-btn")||e.target.closest(".dyslexic-btn")||(e.stopPropagation(),this.classList.remove("minimized"),minimizeBtn.textContent="─",minimizeBtn.title="Réduire",console.log("Panel expanded from minimized state"))},n=function(e){e.preventDefault(),e.stopPropagation(),accessPanel.classList.toggle("minimized"),accessPanel.classList.contains("minimized")?(minimizeBtn.textContent="▼",minimizeBtn.title="Agrandir",console.log("Panel minimized")):(minimizeBtn.textContent="─",minimizeBtn.title="Réduire",console.log("Panel expanded"))},accessPanel.addEventListener("click",t),minimizeBtn.addEventListener("click",n,!0)))}console.log("Access panel found, initializing..."),handleMobileBehavior(),window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout((function(){handleMobileBehavior()}),150)}))}const langBtn=document.getElementById("langBtn"),langDropdown=document.getElementById("langDropdown");langBtn&&langDropdown&&(langBtn.addEventListener("click",(function(e){e.stopPropagation(),langDropdown.classList.toggle("show"),langBtn.classList.toggle("active")})),document.addEventListener("click",(function(){langDropdown.classList.remove("show"),langBtn.classList.remove("active")})),langDropdown.addEventListener("click",(function(e){e.stopPropagation()}))),document.querySelectorAll(".nav-link").forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("href");t.startsWith("#")&&document.querySelector(t)?.scrollIntoView({behavior:"smooth"})}))})),document.querySelector(".fullscreen-btn")?.addEventListener("click",(function(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()})),document.querySelector(".select-btn")?.addEventListener("click",(function(){console.log("Select dropdown clicked")}));const character=document.querySelector(".character-circle");if(character){character.addEventListener("mousemove",(function(e){const t=this.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top,i=t.width/2,c=(o-t.height/2)/20,s=(i-n)/20;this.style.transform=`perspective(1000px) rotateX(${c}deg) rotateY(${s}deg)`})),character.addEventListener("mouseleave",(function(){this.style.transform="perspective(1000px) rotateX(0) rotateY(0)"}));let c=0,s=[];const a=20,r=2e4;character.addEventListener("click",(function(){const e=Date.now();if(s.push(e),s=s.filter((t=>e-t<r)),c=s.length,c>=a){const e=new Audio(String.fromCharCode(105,109,97,103,101,115,47,107,233,122,233,99,233,46,109,112,51));e.volume=.3,e.play();const t=character.querySelector(String.fromCharCode(46,99,104,97,114,97,99,116,101,114,45,105,109,103));t&&(t.src=String.fromCharCode(105,109,97,103,101,115,47,103,105,112,104,121,46,103,105,102)),c=0,s=[]}}))}const aboutTitle=document.querySelector(".section-title"),aboutApparition=document.querySelector(".apparition");if(aboutTitle){const l=(e,t)=>{e.forEach((e=>{e.isIntersecting&&(setTimeout((()=>{aboutTitle.classList.add("pseudo-style"),setTimeout((()=>{aboutApparition&&aboutApparition.classList.add("visible")}),1e3)}),1e3),t.unobserve(e.target))}))};new IntersectionObserver(l,{root:null,rootMargin:"0px",threshold:.5}).observe(aboutTitle)}const workSection=document.querySelector(".work");if(workSection){const d=workSection.querySelector(".section-title"),u=workSection.querySelector(".apparition-work");if(d){new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(setTimeout((()=>{d.classList.add("pseudo-style"),setTimeout((()=>{u&&u.classList.add("visible")}),1e3)}),1e3),t.unobserve(e.target))}))}),{root:null,rootMargin:"0px",threshold:.5}).observe(d)}}const contactSection=document.querySelector(".contact");if(contactSection){const m=contactSection.querySelector(".section-title"),v=contactSection.querySelector(".apparition-contact");if(m){new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(setTimeout((()=>{m.classList.add("pseudo-style"),setTimeout((()=>{v&&v.classList.add("visible")}),1e3)}),1e3),t.unobserve(e.target))}))}),{root:null,rootMargin:"0px",threshold:.5}).observe(m)}}const workItems=document.querySelectorAll(".work-item"),workGrid=document.querySelector(".work-grid");function trapFocus(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],o=t[t.length-1];e.addEventListener("keydown",(function(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===n&&(o.focus(),e.preventDefault()):document.activeElement===o&&(n.focus(),e.preventDefault()))}))}function initCarousel(e){const t=e.querySelector(".carousel-track"),n=e.querySelectorAll(".project-slide"),o=e.querySelector(".carousel-prev"),i=e.querySelector(".carousel-next"),c=e.querySelector(".carousel-indicators");if(!t||0===n.length)return;let s=0;c.innerHTML="",n.forEach(((e,t)=>{const o=document.createElement("button");o.classList.add("carousel-indicator"),o.setAttribute("role","tab"),o.setAttribute("aria-label",`Aller à la diapositive ${t+1} sur ${n.length}`),o.setAttribute("aria-selected",0===t?"true":"false"),0===t&&o.classList.add("active"),o.addEventListener("click",(e=>{e.stopPropagation(),function(e){s=e,r()}(t)})),c.appendChild(o)}));const a=e.querySelectorAll(".carousel-indicator");function r(){const e=100*-s;t.style.transform=`translateX(${e}%)`,a.forEach(((e,t)=>{const n=t===s;e.classList.toggle("active",n),e.setAttribute("aria-selected",n?"true":"false")})),o.disabled=0===s,i.disabled=s===n.length-1,o.setAttribute("aria-disabled",0===s?"true":"false"),i.setAttribute("aria-disabled",s===n.length-1?"true":"false"),t.setAttribute("aria-label",`Diapositive ${s+1} sur ${n.length}`)}function l(){s<n.length-1&&(s++,r())}function d(){s>0&&(s--,r())}o.addEventListener("click",(e=>{e.stopPropagation(),d()})),i.addEventListener("click",(e=>{e.stopPropagation(),l()}));const u=t=>{const n=e.querySelector(".work-item-detail");n&&n.open?"ArrowLeft"===t.key?(t.preventDefault(),d()):"ArrowRight"===t.key&&(t.preventDefault(),l()):document.removeEventListener("keydown",u)};document.addEventListener("keydown",u),r(),setTimeout((()=>{e.querySelectorAll(".project-card-music, .project-card-access, .project-card-devweb, .project-card-photo, .project-card-video").forEach((e=>{checkScrollable(e),e.addEventListener("scroll",(()=>{checkScrollable(e)}))}))}),100);e.querySelectorAll(".project-card-photo").forEach((e=>{const t=e.querySelector("img");t&&(t.complete?checkImageOrientation(t,e):t.addEventListener("load",(()=>{checkImageOrientation(t,e)})))}))}function checkImageOrientation(e,t){e.naturalWidth/e.naturalHeight<.9?t.classList.add("vertical-layout"):t.classList.remove("vertical-layout")}function checkScrollable(e){if(e.scrollHeight>e.clientHeight){e.scrollHeight-e.scrollTop<=e.clientHeight+10?e.classList.remove("has-scroll"):e.classList.add("has-scroll")}else e.classList.remove("has-scroll")}workItems.forEach((e=>{const t=e.querySelector(".work-item-detail"),n=e.querySelector(".close-btn");let o=null;function i(){o=document.activeElement;const i=document.querySelector(".work-item-detail[open]");i&&i!==t&&i.close(),t.showModal(),document.body.style.overflow="hidden",initCarousel(e),trapFocus(t),setTimeout((()=>{n&&n.focus()}),100)}function c(){t.close(),document.body.style.overflow="",o&&o.focus()}e.addEventListener("click",(function(e){if(e.target.closest(".close-btn")||e.target.closest(".carousel-btn")||e.target.closest(".carousel-indicator"))return;const t=document.getElementById("work");t?(t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout((()=>{i()}),500)):i()})),e.addEventListener("keydown",(function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())})),n&&n.addEventListener("click",(function(e){e.stopPropagation(),c()})),t.addEventListener("click",(function(e){const n=t.getBoundingClientRect();e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom||c()})),t.addEventListener("keydown",(function(e){"Escape"===e.key&&c()}))}));